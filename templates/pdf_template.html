<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Reporte PDF</title>
    <style>
      @page {
        size: A4 landscape;
        margin: 1cm;
      }
      body {
        font-family: Helvetica, Arial, sans-serif;
        font-size: 10pt;
        color: #000;
        line-height: 1.3;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15px;
      }
      td {
        padding: 5px 8px;
        vertical-align: middle;
      }

      /* CAJAS DE ENCABEZADO */
      .header-box {
        background-color: #e0e0e0;
        border: 1px solid #000;
        text-align: center;
        font-weight: bold;
        font-size: 14pt;
        padding: 10px;
        margin-bottom: 15px;
        text-transform: uppercase;
      }

      .info-table td {
        border: 1px solid #000;
      }
      .label-cell {
        background-color: #f0f0f0;
        font-weight: bold;
        width: 20%;
      }
      .value-cell {
        width: 30%;
        text-align: center;
      }

      /* TABLA DE TOTALES (RESUMEN) */
      .section-title {
        font-weight: bold;
        text-decoration: underline;
        margin-bottom: 5px;
        font-size: 11pt;
      }

      .totals-table {
        width: 60%;
      } /* Ancho reducido para que se lea mejor */
      .totals-table td {
        border-bottom: 1px solid #ccc;
      }

      .total-row-label {
        text-align: left;
      }
      .total-row-value {
        text-align: right;
        font-weight: bold;
      }

      .final-total td {
        border-top: 2px solid #000;
        border-bottom: 2px solid #000;
        background-color: #f9f9f9;
        font-size: 12pt;
        font-weight: bold;
        padding: 10px 8px;
      }

      /* TABLA DETALLE */
      .detail-header {
        background-color: #333;
        color: #fff;
        text-align: center;
        font-weight: bold;
        font-size: 10pt;
        padding: 5px;
      }
      .detail-table td {
        border: 1px solid #000;
        font-size: 9pt;
        text-align: center;
      }
      .detail-th {
        background-color: #d9d9d9;
        font-weight: bold;
      }
      .text-right {
        text-align: right !important;
      }
      .text-left {
        text-align: left !important;
      }
    </style>
  </head>
  <body>
    <div class="header-box">
      {% if 'Arena' in tipo_reporte %} Liquidación de Venta de Arena {% else %}
      Certificado de Flete {% endif %}
    </div>

    <table class="info-table">
      <tr>
        <td class="label-cell">Fecha Emisión</td>
        <td class="value-cell">{{ fecha_emision }}</td>
        <td class="label-cell">
          {% if 'Arena' in tipo_reporte %}Cliente{% else %}Transportista{% endif
          %}
        </td>
        <td class="value-cell">{{ empresa }}</td>
      </tr>
      <tr>
        <td class="label-cell">Período</td>
        <td colspan="3" style="text-align: center">
          Desde <strong>{{ periodo_inicio }}</strong> hasta
          <strong>{{ periodo_fin }}</strong>
        </td>
      </tr>
    </table>

    <div class="section-title">Resumen Económico</div>

    <table class="totals-table">
      <tr>
        <td class="total-row-label">Total Toneladas</td>
        <td class="total-row-value">
          {{ "%.2f"|format(total_tn|default(0)) }} Tn
        </td>
      </tr>
      <tr>
        <td class="total-row-label">
          {% if 'Arena' in tipo_reporte %}Precio Base ($/Tn){% else %}Tarifa
          Flete ($/Tn){% endif %}
        </td>
        <td class="total-row-value">
          $ {{ "{:,.2f}".format(precio_unitario|default(0)) }}
        </td>
      </tr>

      <tr>
        <td class="total-row-label">Subtotal</td>
        <td class="total-row-value">
          $ {{ "{:,.2f}".format(subtotal|default(0)) }}
        </td>
      </tr>

      {% if descuento_dinero and descuento_dinero > 0 %}
      <tr>
        <td class="total-row-label" style="color: #b91c1c">
          Descuentos / Mermas
        </td>
        <td class="total-row-value" style="color: #b91c1c">
          - $ {{ "{:,.2f}".format(descuento_dinero) }}
        </td>
      </tr>
      {% endif %}

      <tr class="final-total">
        <td>TOTAL NETO</td>
        <td class="text-right">
          $ {{ "{:,.2f}".format(total_neto|default(0)) }}
        </td>
      </tr>

      <tr>
        <td style="font-size: 8pt; color: #666; border: none">
          IVA (21%) Estimado
        </td>
        <td
          style="font-size: 8pt; color: #666; text-align: right; border: none"
        >
          $ {{ "{:,.2f}".format((total_iva_inc|default(0)) -
          (total_neto|default(0))) }}
        </td>
      </tr>
      <tr>
        <td style="font-size: 9pt; font-weight: bold; border: none">
          TOTAL CON IVA
        </td>
        <td
          style="
            font-size: 9pt;
            font-weight: bold;
            text-align: right;
            border: none;
          "
        >
          $ {{ "{:,.2f}".format(total_iva_inc|default(0)) }}
        </td>
      </tr>
    </table>

    <br />

    <div class="detail-header">Detalle de Movimientos</div>

    <table class="detail-table" cellspacing="0" cellpadding="0">
      <tr class="detail-th">
        <td width="12%">Remito</td>
        <td width="12%">Fecha</td>
        <td width="26%">Chofer</td>
        <td width="12%">Patente</td>
        <td
          width="12%"
          style="{{ 'background-color: #bbb;' if 'Arena' in tipo_reporte else '' }}"
        >
          Tn Origen
        </td>
        <td
          width="12%"
          style="{{ 'background-color: #bbb;' if not 'Arena' in tipo_reporte else '' }}"
        >
          Tn Destino
        </td>
        <td width="14%">Total ($)</td>
      </tr>
      {% for item in items %}
      <tr>
        <td>{{ item.remito }}</td>
        <td>
          {{ item.f_llegada if item.f_llegada != '-' else item.f_salida }}
        </td>
        <td class="text-left">{{ item.chofer }}</td>
        <td>{{ item.patente }}</td>

        <td>
          {% if 'Arena' in tipo_reporte %}<strong
            >{% endif %} {{ "%.2f"|format(item.peso_salida|default(0)) }} {% if
            'Arena' in tipo_reporte %}</strong
          >{% endif %}
        </td>

        <td>
          {% if not 'Arena' in tipo_reporte %}<strong
            >{% endif %} {{ "%.2f"|format(item.peso_llegada|default(0)) }} {% if
            not 'Arena' in tipo_reporte %}</strong
          >{% endif %}
        </td>

        <td class="text-right">
          $ {{ "{:,.0f}".format(item.total_linea|default(0)) }}
        </td>
      </tr>
      {% endfor %}
    </table>
  </body>
</html>
